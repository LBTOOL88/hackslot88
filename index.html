<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>HACK GAME SLOT - A.I LONG B·∫¢O 88</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #00ff7f; /* Green */
            --vip-color: #ffc107; /* Gold for VIP */
            --text-light: #f0f0f0;
            --bg-dark-theme: #0d1117;
            --container-bg: rgba(13, 17, 23, 0.75);
            --input-bg: #161b22;
            --border-color: rgba(0, 255, 127, 0.25);
            --button-radius: 12px;
            --container-radius: 16px;
            --error-red: #ff4757;
            --aurora-speed: 5s;
        }
        @keyframes aurora-flow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes pulse { from { transform: scale(1); } to { transform: scale(1.03); } }
        @keyframes online-blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
        @keyframes vip-glow {
            0% { border-color: #00ff7f; box-shadow: 0 0 15px #00ff7f, inset 0 0 5px rgba(0, 255, 127, 0.5); }
            25% { border-color: #00bfff; box-shadow: 0 0 20px #00bfff, inset 0 0 7px rgba(0, 191, 255, 0.5); }
            50% { border-color: #ff00c1; box-shadow: 0 0 25px #ff00c1, inset 0 0 10px rgba(255, 0, 193, 0.5); }
            75% { border-color: #ffb300; box-shadow: 0 0 20px #ffb300, inset 0 0 7px rgba(255, 179, 0, 0.5); }
            100% { border-color: #00ff7f; box-shadow: 0 0 15px #00ff7f, inset 0 0 5px rgba(0, 255, 127, 0.5); }
        }
        @keyframes vip-chat-glow {
            0% { box-shadow: 0 0 15px var(--vip-color), inset 0 0 8px rgba(255, 193, 7, 0.6); border-color: var(--vip-color); }
            50% { box-shadow: 0 0 25px #fff, inset 0 0 12px rgba(255, 255, 255, 0.8); border-color: #fff; }
            100% { box-shadow: 0 0 15px var(--vip-color), inset 0 0 8px rgba(255, 193, 7, 0.6); border-color: var(--vip-color); }
        }

        html, body { margin: 0; padding: 0; font-family: 'Roboto', Arial, sans-serif; background: var(--bg-dark-theme); color: var(--text-light); overflow-x: hidden; }
        .hidden { display: none !important; }
        .orbitron-font { font-family: 'Orbitron', sans-serif; }

        #video-background { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 0; opacity: 0.6; }
        #video-background iframe { position: absolute; top: 50%; left: 50%; width: 100vw; height: 100vh; transform: translate(-50%, -50%); object-fit: cover; transition: opacity 0.7s ease-in-out; opacity: 0; pointer-events: none; }
        #video-background iframe.active { opacity: 1; }

        #cinematicIntroOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; transition: opacity 1s ease-out; cursor: pointer; }
        #introTextContainer { text-align: center; }
        #introTextContainer h1 { font-family: 'Orbitron', sans-serif; font-size: 2.5em; text-transform: uppercase; color: #fff; text-shadow: 0 0 15px var(--primary-color); opacity: 0; transition: opacity 0.8s ease-in-out; }
        #introTextContainer h1.visible { opacity: 1; }
        @media (max-width: 600px) { #introTextContainer h1 { font-size: 1.8em; } }

        .page-container { position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; min-height: 100vh; padding: 20px; box-sizing: border-box; }
        .form-container, .main-content { border: 2px solid var(--border-color); border-radius: var(--container-radius); padding: 30px 40px; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37); animation: fadeInUp 0.8s ease-out; text-align: center; }
        .form-container { background: rgba(13, 17, 23, 0.45); backdrop-filter: none; -webkit-backdrop-filter: none; }
        .main-content { position: relative; background: var(--container-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); max-width: 620px; }
        
        .main-content.vip-mode {
             --border-color: rgba(255, 193, 7, 0.5);
             background: rgba(20, 15, 0, 0.75);
        }

        #loginLogo { max-width: 120px; margin-bottom: 25px; border-radius: 50%; border: 3px solid var(--primary-color); }
        .intro-title, header h1, #welcomeMessage { font-family: 'Orbitron', sans-serif; text-transform: uppercase; background: linear-gradient(90deg, var(--primary-color), #ff00c1, #ffb300, var(--primary-color)); background-size: 400%; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: aurora-flow 8s linear infinite; text-shadow: 0 0 10px rgba(255,255,255,0.2); }
        .intro-title { font-size: 2em; margin-bottom: 30px; }
        header h1 { font-size: 1.8em; margin: 0; }
        #welcomeMessage { font-size: 1.1em; margin-bottom: 20px; }

        header { width: 100%; background-color: rgba(13, 17, 23, 0.8); padding: 15px; text-align: center; border-bottom: 2px solid var(--border-color); backdrop-filter: blur(10px); box-sizing: border-box; }
        #aiChoiceContainer, #scanningContainer, #resultContainer, #gameSelectionContainer { display: flex; flex-direction: column; gap: 20px; animation: fadeInUp 0.6s ease-out forwards; }

        #coin-display {
            grid-column: 1 / -1; background: rgba(0,0,0,0.3); border-radius: var(--button-radius);
            padding: 10px 15px; margin-bottom: 20px; border: 1px solid var(--border-color);
            display: flex; align-items: center; gap: 15px;
        }
        #coin-display .coin-icon { width: 30px; height: 30px; color: var(--vip-color); }
        #coin-display .coin-text { font-family: 'Orbitron', sans-serif; font-size: 1.2em; color: var(--text-light); flex-shrink: 0; }
        #coin-bar-wrapper { flex-grow: 1; height: 12px; background: rgba(0,0,0,0.5); border-radius: 6px; overflow: hidden; border: 1px solid #000; }
        #coin-bar { height: 100%; width: 100%; background: linear-gradient(90deg, var(--vip-color), #ffd700); border-radius: 6px; transition: width 0.5s ease-in-out; }

        #menuContainer {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; animation: fadeInUp 0.6s ease-out forwards;
        }
        .menu-btn {
            background: transparent; font-size: 1em; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;
            box-sizing: border-box; padding: 12px; border-radius: var(--button-radius); cursor: pointer;
            transition: all 0.3s ease-in-out; position: relative; display: flex; flex-direction: column;
            align-items: center; justify-content: center; min-height: 100px; text-align: center; 
        }
        .menu-btn svg { width: 32px; height: 32px; margin-bottom: 8px; transition: all 0.3s ease; flex-shrink: 0; }
        .menu-btn .menu-text { font-size: 0.85em; line-height: 1.2; }
        .menu-btn:hover svg { transform: scale(1.1); }

        .menu-base .menu-btn { color: var(--primary-color); border: 1px solid var(--border-color); }
        .menu-base .menu-btn:hover { background: var(--primary-color); color: var(--bg-dark-theme); transform: translateY(-5px); border-color: var(--primary-color); box-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color); }

        .menu-vip .menu-btn { color: var(--vip-color); border: 1px solid var(--vip-color); }
        .menu-vip .menu-btn:hover { background: var(--vip-color); color: var(--bg-dark-theme); transform: translateY(-5px); border-color: var(--vip-color); box-shadow: 0 0 10px var(--vip-color), 0 0 20px var(--vip-color); }

        #backToChoiceBtn {
            grid-column: 1 / -1; flex-direction: row; background-color: transparent; border: 1px solid #6c757d; color: #6c757d;
        }
        #backToChoiceBtn:hover { background: #6c757d; color: var(--text-light); border-color: #6c757d; box-shadow: 0 0 10px #6c757d; }
        #backToChoiceBtn svg { width: 24px; height: 24px; margin-bottom: 0; margin-right: 10px; }
        
        #playWithAIBtn { grid-column: 1 / -1; border-width: 2px; animation: vip-chat-glow 3s linear infinite; }
        
        input[type="text"], input[type="number"] { padding: 14px 20px; margin: 10px 0; width: 100%; max-width: 300px; border-radius: var(--button-radius); border: 1px solid var(--border-color); background: var(--input-bg); color: var(--text-light); font-size: 1em; box-shadow: inset 0 1px 3px rgba(0,0,0,0.3); transition: all 0.3s; box-sizing: border-box; }
        input[type="text"]:focus, input[type="number"]:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 10px var(--primary-color); }
        .action-button { padding: 14px 30px; background: linear-gradient(45deg, #f093fb, #f5576c); color: white; border: none; font-weight: bold; border-radius: var(--button-radius); margin-top: 25px; cursor: pointer; font-size: 1.1em; text-transform: uppercase; box-shadow: 0 4px 15px rgba(0,0,0, 0.2); transition: all 0.3s ease; position: relative; overflow: hidden; }
        .action-button:hover { transform: translateY(-5px) scale(1.05); box-shadow: 0 10px 20px rgba(245, 87, 108, 0.4); }
        
        .choice-card { border: 2px solid var(--border-color); border-radius: var(--container-radius); padding: 25px; text-align: center; cursor: pointer; transition: all 0.3s ease-in-out; background: rgba(22, 27, 34, 0.8); backdrop-filter: blur(5px); }
        .choice-card:hover { transform: translateY(-5px); border-color: var(--primary-color); background: rgba(35, 42, 53, 0.9); }
        #choiceAILongBao4 { border: 2px solid; animation: vip-glow 6s linear infinite; }
        #choiceAILongBao4 h3 { background: linear-gradient(90deg, #00bfff, #ff00c1, #ffb300, #00bfff); background-size: 400%; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: aurora-flow 6s linear infinite; }
        #choiceAILongBao4:hover { transform: translateY(-8px) scale(1.03); }
        .choice-card.disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }
        .choice-card h3 { margin-top: 0; font-size: 1.5em; }

        #error, #codeError { color: var(--error-red); margin-top: 20px; font-weight: bold; min-height: 1.2em; }
        
        #scanningContainer { text-align: center; }
        #loadingGif { max-width: 150px; margin: 15px auto; mix-blend-mode: screen; border-radius: 8px; }
        #resultContainer h2, #scanningContainer h3, #financeAllocatorContainer h3, #gameSelectionContainer h3 { background: linear-gradient(90deg, var(--primary-color), #ff00c1, #ffb300, var(--primary-color)); background-size: 400%; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: aurora-flow 8s linear infinite; }
        .result-stats { padding: 15px; margin-top: 15px; }
        .result-stats p strong { color: transparent; background: linear-gradient(90deg, var(--primary-color), #ffb300); -webkit-background-clip: text; background-clip: text; }
        #goldenTimeContainer { background: linear-gradient(45deg, #ffc107, #ff9800); color: var(--bg-dark-theme); padding: 15px; border-radius: var(--container-radius); margin-top: 20px; text-align: center; border: 2px solid #ffeb3b; box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); animation: pulse 2s infinite alternate; }
        #scanReasoning { font-style: italic; color: #f5a623; margin-top: 20px; font-size: 1.1em; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); display: flex; align-items: center; justify-content: center; z-index: 9000; backdrop-filter: blur(5px); }
        .modal-content { padding: 30px; width: 90%; max-width: 500px; text-align: center; background: var(--container-bg); border: 2px solid var(--border-color); border-radius: var(--container-radius); animation: fadeInUp 0.5s ease-out; box-sizing: border-box; }
        .modal-content h2 { font-family: 'Orbitron', sans-serif; }
        #securityMessage { text-align: left; line-height: 1.8; font-family: 'Courier New', Courier, monospace; font-size: 0.9em; height: 250px; overflow-y: auto; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; }

        #registration-banner { margin-top: 25px; border-top: 1px solid var(--border-color); padding-top: 20px; font-size: 0.9em; opacity: 0.9; }
        #registration-banner p { margin: 8px 0; }
        #registration-banner a { color: var(--primary-color); text-decoration: none; font-weight: bold; }
        #registration-banner a:hover { text-decoration: underline; }
        
        #game-list { max-height: 40vh; overflow-y: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .game-btn { background: rgba(22, 27, 34, 0.8); border: 1px solid var(--border-color); color: var(--text-light); padding: 15px 10px; border-radius: var(--button-radius); cursor: pointer; transition: all 0.3s ease; text-align: center; font-size: 0.9em; }
        .game-btn:hover { background: var(--primary-color); color: var(--bg-dark-theme); font-weight: bold; }
        
        #historyContent { max-height: 50vh; overflow-y: auto; text-align: left; }
        .history-item { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 3px solid var(--primary-color); }
        .history-item p { margin: 5px 0; }

        #settingsBtn { position: absolute; top: 15px; right: 15px; font-size: 1.8em; cursor: pointer; transition: transform 0.3s ease; }
        #settingsBtn:hover { transform: rotate(90deg); }
        .settings-section { margin: 20px 0; border-top: 1px solid var(--border-color); padding-top: 20px; }
        .color-swatches { display: flex; justify-content: center; gap: 15px; }
        .swatch { width: 30px; height: 30px; border-radius: 50%; cursor: pointer; border: 2px solid var(--text-light); }
        .swatch.active { box-shadow: 0 0 10px 2px #fff; }

        #dynamicDashboard { 
            border: 1px solid var(--border-color); padding: 10px; margin-bottom: 20px; border-radius: var(--button-radius); 
            display: flex; flex-wrap: wrap; justify-content: space-around; font-size: 0.8em; text-transform: uppercase; 
        }
        #systemStatus::before { content: '‚óè'; margin-right: 5px; color: var(--primary-color); animation: online-blink 2s infinite; }
    </style>
</head>
<body>

<audio id="clickSound" src="https://www.myinstants.com/media/sounds/mouse-click.mp3" preload="auto"></audio>
<audio id="scanSound" src="https://www.myinstants.com/media/sounds/modem-dial-up-4.mp3" loop preload="auto"></audio>
<audio id="successSound" src="https://www.myinstants.com/media/sounds/correct-answer.mp3" preload="auto"></audio>
<audio id="errorSound" src="https://www.myinstants.com/media/sounds/error_CD_dM99Fr1.mp3" preload="auto"></audio>

<div id="video-background">
    <iframe id="video-login" src="https://streamable.com/e/p75ki3?autoplay=1&mute=1&loop=1" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>
    <iframe id="video-ai-choice" src="https://streamable.com/e/d7r3dn?autoplay=1&mute=1&loop=1" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>
    <iframe id="video-menu" src="https://streamable.com/e/luj9cq?autoplay=1&mute=1&loop=1" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>
</div>

<div id="cinematicIntroOverlay">
    <div id="introTextContainer">
        <h1 id="introLine1">H·ªÜ TH·ªêNG TR√ç TU·ªÜ NH√ÇN T·∫†O</h1>
        <h1 id="introLine2">LONG B·∫¢O 88</h1>
        <h1 id="introLine3">A.I PH√ÇN T√çCH SLOT TH√îNG MINH NH·∫§T</h1>
    </div>
</div>

<div id="loginScreen" class="page-container hidden">
    <div class="form-container">
        <img src="https://i.ibb.co/TBTkX4PT/photo-2025-05-31-22-38-07.jpg" alt="Logo" id="loginLogo">
        <h2 class="intro-title orbitron-font">ƒêƒÇNG NH·∫¨P H·ªÜ TH·ªêNG</h2>
        <input type="text" id="username" placeholder="T√™n t√†i kho·∫£n" />
        <input type="text" id="loginCode" placeholder="M√£ truy c·∫≠p" />
        <button class="action-button" onclick="checkLoginCode()">X√°c nh·∫≠n</button>
        <p id="error"></p>
        <div id="registration-banner">
            <p>ƒêƒÇNG K√ç T√ÄI KHO·∫¢N T·∫†I <a href="http://www.f168.codes" target="_blank" rel="noopener noreferrer">WWW.F168.CODES</a></p>
            <p>LI√äN H·ªÜ LONG B·∫¢O: <span style="color: var(--primary-color); font-weight: bold;">@LONGBAOF168</span></p>
        </div>
    </div>
</div>

<div id="appScreen" class="page-container hidden">
    <header>
        <h1 class="orbitron-font">A.I LONG B·∫¢O 88</h1>
    </header>
    <div class="main-content" id="mainContent">
        <div id="settingsBtn">‚öôÔ∏è</div>
        <div id="aiChoiceContainer" class="hidden">
            <p id="welcomeMessage"></p>
            <div class="choice-card" id="choiceAILongBao"> <h3 class="orbitron-font">A.I LONG B·∫¢O</h3> <p>Phi√™n b·∫£n c∆° b·∫£n</p> </div>
            <div class="choice-card" id="choiceAILongBao4"> <h3 class="orbitron-font">A.I LONG B·∫¢O TH·∫æ H·ªÜ 4</h3> <p>Phi√™n b·∫£n n√¢ng cao (y√™u c·∫ßu m√£)</p> </div>
            <div class="choice-card disabled"> <h3 class="orbitron-font">A.I TH·∫æ H·ªÜ 5</h3> <p>(S·∫ÆP RA M·∫ÆT)</p> </div>
        </div>
        
        <div id="menuContainer" class="hidden">
            <div id="dynamicDashboard" style="grid-column: 1 / -1;">
                <span>Tr·∫°ng th√°i: <span id="systemStatus"></span></span>
                <span>Ping: <span id="networkPing"></span></span>
                <span>A.I: <span id="activeAI"></span></span>
            </div>
            
            <div id="coin-display">
                <svg class="coin-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"/><path d="M12 6c-2.757 0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5zm0 8c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3z"/></svg>
                <span class="coin-text">Xu: <span id="coin-count">0</span></span>
                <div id="coin-bar-wrapper"><div id="coin-bar"></div></div>
            </div>

            <button class="menu-btn orbitron-font" id="playWithAIBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-4H6V6h12v2z"/></svg>
                <span class="menu-text">Ch∆°i C√πng A.I</span>
            </button>
            <button class="menu-btn orbitron-font" id="jarHuntBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-12h2v4h-2zm0 6h2v2h-2z"/></svg>
                <span class="menu-text">SƒÉn H≈©</span>
            </button>
            <button class="menu-btn orbitron-font" id="autoScanBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3C7.03 3 3 7.03 3 12s4.03 9 9 9 9-4.03 9-9c0-4.97-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/><path d="M16.24 7.76C15.07 6.59 13.54 6 12 6v6l4.24 4.24c2.34-2.34 2.34-6.14 0-8.48z" opacity=".3"/></svg>
                <span class="menu-text">T·ª± ƒê·ªông Qu√©t</span>
            </button>
            <button class="menu-btn orbitron-font" id="startAnalysisBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                <span class="menu-text">Ph√¢n T√≠ch Game</span>
            </button>
            <button class="menu-btn orbitron-font" id="historyBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6a7 7 0 0 1 7-7 7 7 0 0 1 7 7 7 7 0 0 1-7 7v2a9 9 0 0 0 9-9c0-4.97-4.03-9-9-9z"/><path d="M12 8v5l4.25 2.52.75-1.23-3.5-2.07V8z"/></svg>
                <span class="menu-text">L·ªãch s·ª≠</span>
            </button>
            <button class="menu-btn orbitron-font" id="securityCheckBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>
                <span class="menu-text">B·∫£o M·∫≠t</span>
            </button>
            <button class="menu-btn orbitron-font" id="capitalPreserveBtn">
                 <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.9 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                <span class="menu-text">B·∫£o To√†n V·ªën</span>
            </button>
            <button class="menu-btn orbitron-font" id="backToChoiceBtn">
                 <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                 <span class="menu-text">Quay L·∫°i</span>
            </button>
        </div>

        <div id="gameSelectionContainer" class="hidden">
            <h3 class="orbitron-font">CH·ªåN GAME ƒê·ªÇ PH√ÇN T√çCH</h3>
            <div id="game-list"></div>
            <button class="back-btn orbitron-font" id="backToMenuFromGameSelectBtn" style="margin-top: 20px;">Quay L·∫°i Menu</button>
        </div>
        <div id="scanningContainer" class="hidden">
            <h3 class="orbitron-font" id="scanTitle">ƒêANG PH√ÇN T√çCH L·ªñ H·ªîNG...</h3>
            <img src="" alt="Scanning..." id="loadingGif">
        </div>
        <div id="resultContainer" class="hidden">
            <h2 class="orbitron-font" id="gameName"></h2>
            <img id="gameImage" src="" alt="Game Image" style="width: 100%; max-width: 200px; margin: 15px auto; display: block; border-radius: 8px;">
            <div id="scanReasoning"></div>
            <div class="result-stats">
                <p><strong>T·ªà L·ªÜ TH·∫ÆNG:</strong> <span id="winRate"></span></p>
                <p><strong>S·ªê V√íNG XOAY:</strong> <span id="spinCount"></span></p>
                <p><strong>T·ªà L·ªÜ R∆†I SCATTER:</strong> <span id="scatterRate"></span></p>
            </div>
            <div id="goldenTimeContainer">
                <h3 class="orbitron-font">üåü KHUNG GI·ªú V√ÄNG üåü</h3>
                <span id="goldenTime">ƒêang t√≠nh to√°n...</span>
            </div>
            <div id="financeAllocatorContainer" class="hidden" style="margin-top: 25px; border-top: 2px solid var(--border-color); padding-top: 20px;">
                <h3 class="orbitron-font">TR·ª¢ L√ù T√ÄI CH√çNH</h3>
                <p style="font-size: 0.9em; opacity: 0.8;">Nh·∫≠p t·ªïng v·ªën ƒë·ªÉ nh·∫≠n k·∫ø ho·∫°ch chi ti·∫øt.</p>
                <input type="number" id="capitalInput" placeholder="Nh·∫≠p v·ªën (v√≠ d·ª•: 1000 = 1.000.000ƒë)" style="margin: 15px auto;">
                <button id="calculateFinanceBtn" class="action-button" style="padding: 10px 25px; font-size: 1em; margin-top: 10px;">L√™n K·∫ø Ho·∫°ch</button>
                <div id="financeResult" style="margin-top: 20px; text-align: left; padding: 15px; background: rgba(0,0,0,0.25); border-radius: 8px; line-height: 1.8;"></div>
            </div>
            <button class="back-btn orbitron-font" id="backToMenuBtn" style="margin-top: 25px;">Quay L·∫°i Menu</button>
        </div>
    </div>
</div>

<div id="settingsModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>C√ÄI ƒê·∫∂T</h2>
        <div class="settings-section">
            <p>√Çm thanh</p>
            <input type="checkbox" id="soundToggle" checked>
        </div>
        <div class="settings-section">
            <p>M√†u ch·ªß ƒë·∫°o</p>
            <div class="color-swatches">
                <div class="swatch active" style="background-color: #00ff7f;" data-color="#00ff7f"></div>
                <div class="swatch" style="background-color: #00bfff;" data-color="#00bfff"></div>
                <div class="swatch" style="background-color: #ff4757;" data-color="#ff4757"></div>
            </div>
        </div>
        <button id="closeSettingsModalBtn" class="action-button">ƒê√≥ng</button>
    </div>
</div>
<div id="codeEntryModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>NH·∫¨P M√É K√çCH HO·∫†T</h2>
        <input type="text" id="gen4CodeInput" placeholder="M√£ A.I Th·∫ø H·ªá 4...">
        <button id="submitGen4CodeBtn" class="action-button" style="padding: 10px 20px; font-size: 0.9em;">X√°c nh·∫≠n</button>
        <button id="closeCodeModalBtn" class="action-button" style="padding: 10px 20px; font-size: 0.9em; margin-top: 10px; background: #6c757d;">H·ªßy</button>
    </div>
</div>
<div id="securityCheckModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>KI·ªÇM TRA B·∫¢O M·∫¨T</h2>
        <p id="securityMessage"></p>
        <button id="closeSecurityModalBtn" class="action-button hidden" style="padding: 10px 20px; font-size: 0.9em; margin-top: 15px;">ƒê√£ Hi·ªÉu</button>
    </div>
</div>
<div id="capitalWarningModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>C·∫¢NH B√ÅO</h2>
        <p id="capitalWarningText" style="color: #f5a623;">VUI L√íNG N·∫†P TR√äN 2TR ƒê·ªÇ K√çCH HO·∫†T HO·∫∂C LI√äN H·ªÜ @LONGBAOF168</p>
        <button id="closeWarningModalBtn" class="action-button" style="padding: 10px 20px; font-size: 0.9em;">ƒê√≥ng</button>
    </div>
</div>
<div id="historyModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>L·ªäCH S·ª¨ QU√âT</h2>
        <div id="historyContent"></div>
        <button id="closeHistoryModalBtn" class="action-button" style="padding: 10px 20px; font-size: 0.9em;">ƒê√≥ng</button>
    </div>
</div>
<div id="inactivityWarningModal" class="modal-overlay hidden" style="z-index: 11000;">
    <div class="modal-content" style="border-color: var(--error-red); box-shadow: 0 0 25px var(--error-red);">
        <h2 style="color: var(--error-red);">‚ö†Ô∏è C·∫¢NH B√ÅO B·∫¢O M·∫¨T ‚ö†Ô∏è</h2>
        <p style="font-size: 1.2em; color: #f5a623; line-height: 1.6;">S·∫¢NH GAME ƒêANG THEO D√ïI !<br>H√ÉY T·∫ÆT ƒêI·ªÜN THO·∫†I V√Ä KH·ªûI ƒê·ªòNG L·∫†I NGAY L·∫¨P T·ª®C!</p>
    </div>
</div>

<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/68425b7ddbadee190ffc208d/1it1jaote';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
<script>
    const COIN_STORAGE_KEY = 'longBaoUserCoins_v1';
    
    // --- FIXED LIST OF 100 CODES ---
    const initialCodeCoinData = {
        "180965": 25, "330843": 18, "983745": 12, "164311": 29, "527813": 15,
        "605898": 21, "348981": 17, "842365": 23, "185119": 28, "588371": 11,
        "793918": 19, "947881": 26, "163428": 14, "964722": 22, "886938": 30,
        "423321": 16, "293523": 24, "694587": 13, "106886": 27, "588785": 20,
        "494493": 25, "437508": 18, "262369": 12, "748645": 29, "387348": 15,
        "682663": 21, "826847": 17, "449174": 23, "269222": 28, "311883": 11,
        "459528": 19, "911855": 26, "765431": 14, "314159": 22, "271828": 30,
        "618033": 16, "141421": 24, "173205": 13, "223606": 27, "230258": 20,
        "244948": 25, "264575": 18, "282842": 12, "300000": 29, "316227": 15,
        "331662": 21, "346410": 17, "360555": 23, "374165": 28, "387298": 11,
        "LB4-7H3A": 75, "LB4-F9K2": 88, "LB4-R5T6": 62, "LB4-Y1P0": 99, "LB4-E4D8": 55,
        "LB4-C2V7": 81, "LB4-N6M3": 67, "LB4-B0Z1": 93, "LB4-L8X5": 58, "LB4-Q9W4": 71,
        "LB4-I3U7": 89, "LB4-O1J9": 96, "LB4-G5S2": 64, "LB4-K8E6": 82, "LB4-T4C3": 100,
        "LB4-Z7V1": 66, "LB4-X2M9": 84, "LB4-P6N4": 63, "LB4-A0B8": 97, "LB4-D3F5": 80,
        "LB4-M1R7": 75, "LB4-U8I2": 88, "LB4-V5T0": 62, "LB4-W9C6": 99, "LB4-S3G1": 55,
        "LB4-J4H9": 81, "LB4-1A2B": 67, "LB4-3C4D": 93, "LB4-5E6F": 58, "LB4-7G8H": 71,
        "LB4-9I0J": 89, "LB4-K1L2": 96, "LB4-M3N4": 64, "LB4-O5P6": 82, "LB4-Q7R8": 100,
        "LB4-S9T0": 66, "LB4-U1V2": 84, "LB4-W3X4": 63, "LB4-Y5Z6": 97, "LB4-A7B8": 80,
        "LB4-C9D0": 75, "LB4-E1F2": 88, "LB4-G3H4": 62, "LB4-I5J6": 99, "LB4-K7L8": 55,
        "LB4-M9N0": 81, "LB4-O2P3": 67, "LB4-Q4R5": 93, "LB4-S6T7": 58, "LB4-U8V9": 71
    };
    const featureCosts = {
        autoScan: 2, startAnalysis: 2, securityCheck: 10,
        jarHunt: 10, playWithAI: 20
    };
    
    let currentUserCoins = 0;
    let initialUserCoins = 0;
    let loggedInCode = null;

    const gen4Codes = Object.keys(initialCodeCoinData).filter(code => code.startsWith("LB4"));
    let chosenAI = null;
    let loggedInUsername = '';
    let scanHistory = [];
    let isSoundEnabled = true;
    let dashboardInterval;
    const gameData = [ { name: 'BA CON HEO NH·ªé', image: 'https://i.ibb.co/Q3dYksdQ/BA-CON-HEO-NH.jpg' }, { name: 'B√ÉO K·ªäCH NGON NG·ªåT', image: 'https://i.ibb.co/h1XkFxcw/B-O-K-CH-NG-NG-T.jpg' }, { name: 'B√ÉO KIM TI·ªÄN', image: 'https://i.ibb.co/KpXRkb4n/B-O-KIM-TI-N.jpg' }, { name: 'CU·ªíNG N·ªò M√àO', image: 'https://i.ibb.co/jvnT8Qm1/CU-I-N-M.jpg' }, { name: 'TH·∫¶N T√ÄI GI√Å ƒê√ÅO', image: 'https://i.ibb.co/jXvqdpd/default-4.jpg' }, { name: 'JOKER', image: 'https://i.ibb.co/21C53TfM/JOKER.jpg' }, { name: 'N·ªÆ HO√ÄNG INCA', image: 'https://i.ibb.co/JRgCH2CC/N-HO-NG-INCA.jpg' }, { name: 'ALIBABA', image: 'https://i.ibb.co/6JJzg75v/ALIBABA.jpg' }, { name: 'B√ìNG TH√ÅCH ƒê·∫§U 2', image: 'https://i.ibb.co/bjS6ztq7/B-O-TH-CH-2.jpg' }, { name: 'QUY·ªÄN V∆Ø∆†NG', image: 'https://i.ibb.co/Y4Pky0NW/QUY-N-V-NG.jpg' }, { name: 'SIN CITY', image: 'https://i.ibb.co/FbLYFC28/SINCITY.jpg' }, { name: 'SUPER ACE', image: 'https://i.ibb.co/0z7rq0R/SUPER-ACE.jpg' }, { name: 'TH√ÄNH PH·ªê V√ÄNG', image: 'https://i.ibb.co/5XpkCZ9Z/TH-NH-PH-V-NG.jpg' }, { name: 'TR√ÇU H√öC', image: 'https://i.ibb.co/N5Dst5n/TR-U-H-C.jpg' }, { name: 'ƒê∆Ø·ªúNG M·∫†T CH∆Ø·ª¢C 2', image: 'https://i.ibb.co/9HzhpDSZ/NG-M-T-CH-C-2.jpg' }, { name: 'ƒê∆Ø·ªúNG M·∫†T CH∆Ø·ª¢T', image: 'https://i.ibb.co/CsvS9Jq7/NG-M-T-CH-T.jpg' }, { name: 'GANESHA V√ÄNG', image: 'https://i.ibb.co/tPKDFgXJ/GANESHA-V-NG.jpg' }, { name: 'K·ª≤ L√ÇN M·∫† V√ÄNG', image: 'https://i.ibb.co/S7srXvxc/K-L-N-M-CH-N-C.jpg' }, { name: 'KHO B√ÅU AZTEC', image: 'https://i.ibb.co/x8g4Yjb3/KHO-B-U-AZTEC.jpg' }, { name: 'MEDUSA 1: L·ªúI NGUY·ªÄN ATHENA', image: 'https://i.ibb.co/DD4JSsQ1/MEDUSA-1-L-I-NGUY-N.jpg' }, { name: 'MEDUSA', image: 'https://i.ibb.co/cKvJ8hQf/MEDUSA.jpg' }, { name: 'NEKO MAY M·∫ÆN', image: 'https://i.ibb.co/RTjCsDvf/NEKO-MAY-M-N.jpg' }, { name: 'N·ªÆ HO√ÄNG TI·ªÄN TH∆Ø·ªûNG', image: 'https://i.ibb.co/fVxjh4rC/N-HO-NG-TI-N-TH-NG.jpg' }, { name: 'QU·ª∂ T·ª¨ CHI·∫æN TI·ªÄN TH∆Ø·ªûNG', image: 'https://i.ibb.co/7Nx37ftx/QUY-T-CHI-N-TI-N-TH-NG.jpg' }, { name: 'TH·ªé MAY M·∫ÆN', image: 'https://i.ibb.co/RTXxqQP0/TH-MAY-M-N.jpg' }, { name: 'VUA KH·ª¶NG LONG', image: 'https://i.ibb.co/gbTBKrjg/VUA-C-NG-LONG.jpg' }, { name: 'WILD OTTER', image: 'https://i.ibb.co/srLdPjG/WILD-O-T-C.jpg' }, { name: 'ZOMBIE BREAKER', image: 'https://i.ibb.co/wFnHkL3N/ZOMBIE-BREAKER.jpg' }, { name: 'L·ªÑ H·ªòI BIA', image: 'https://i.ibb.co/8gwq7PmY/U-B-P-B-N.jpg' }, { name: 'KHU TI·ªÄN M·∫∂T 777', image: 'https://i.ibb.co/SD2Rgf31/KHU-TI-N-M-T-777.jpg' }, { name: 'NOEL BIG BANG', image: 'https://i.ibb.co/Z69fZ2qZ/NOEL-BIG-BANG.jpg' }, { name: 'NG√ÄY T·∫¨N TH·∫æ', image: 'https://i.ibb.co/Rk2tR28N/NG-Y-T-N-TH.jpg' }, { name: 'NHI·ªÜM V·ª§ BERMUDA', image: 'https://i.ibb.co/DHG22BF5/NHI-M-V-BERMUDA.jpg' }, { name: 'RACING BULL', image: 'https://i.ibb.co/gbFw5MsH/RACING-BULL.jpg' }, { name: 'RISE OF SAMURAI 4', image: 'https://i.ibb.co/bg6TG5vp/RISE-OF-SAMURAI-4.jpg' }, { name: 'SUGAR RUSH 1000', image: 'https://i.ibb.co/ZjGNbk8/SUGAR-RUSH-1000.jpg' }, { name: 'TIK TAC TAKE', image: 'https://i.ibb.co/fYf5ZfD7/TIK-TAC-TAK.jpg' }, { name: 'V·∫¨N MAY GIZA', image: 'https://i.ibb.co/qYyTgdMS/V-N-MAY-GIZA.jpg' } ];
    
    const DOM = {
        mainContent: document.getElementById('mainContent'),
        cinematicIntro: document.getElementById('cinematicIntroOverlay'), loginScreen: document.getElementById('loginScreen'), appScreen: document.getElementById('appScreen'), aiChoiceContainer: document.getElementById('aiChoiceContainer'), menuContainer: document.getElementById('menuContainer'), scanningContainer: document.getElementById('scanningContainer'), resultContainer: document.getElementById('resultContainer'), gameSelectionContainer: document.getElementById('gameSelectionContainer'),
        videos: { login: document.getElementById('video-login'), aiChoice: document.getElementById('video-ai-choice'), menu: document.getElementById('video-menu') },
        modals: { code: document.getElementById('codeEntryModal'), security: document.getElementById('securityCheckModal'), capital: document.getElementById('capitalWarningModal'), inactivity: document.getElementById('inactivityWarningModal'), history: document.getElementById('historyModal'), settings: document.getElementById('settingsModal') },
        sounds: { click: document.getElementById('clickSound'), scan: document.getElementById('scanSound'), success: document.getElementById('successSound'), error: document.getElementById('errorSound') }
    };
    
    let inactivityTimer, introHasEnded = false;

    function playSound(soundName) { if (isSoundEnabled) { try { if (DOM.sounds[soundName]) { DOM.sounds[soundName].currentTime = 0; DOM.sounds[soundName].play(); } } catch(e) { /* ignore */ } } }
    function stopSound(soundName) { try { if (DOM.sounds[soundName]) { DOM.sounds[soundName].pause(); DOM.sounds[soundName].currentTime = 0; } } catch(e) { /* ignore */ } }
    function setScreenVisibility(show, hide = []) { if (show) show.classList.remove('hidden'); hide.forEach(el => el.classList.add('hidden')); }
    function switchView(show, hide = []) { setScreenVisibility(show, hide); playSound('click'); }
    function updateVideoBackground(activeVideo) { Object.values(DOM.videos).forEach(video => video.classList.remove('active')); if (DOM.videos[activeVideo]) DOM.videos[activeVideo].classList.add('active'); }
    function showModal(modal) { modal.classList.remove('hidden'); }
    function hideModal(modal) { modal.classList.add('hidden'); }
    
    function updateCoinDisplay() {
        document.getElementById('coin-count').textContent = currentUserCoins;
        const percentage = initialUserCoins > 0 ? (currentUserCoins / initialUserCoins) * 100 : 0;
        document.getElementById('coin-bar').style.width = `${percentage}%`;
    }

    function useFeature(featureName, action) {
        playSound('click');
        const cost = featureCosts[featureName];
        if (currentUserCoins >= cost) {
            currentUserCoins -= cost;
            
            let storedCoins = JSON.parse(localStorage.getItem(COIN_STORAGE_KEY));
            storedCoins[loggedInCode] = currentUserCoins;
            localStorage.setItem(COIN_STORAGE_KEY, JSON.stringify(storedCoins));

            updateCoinDisplay();
            action();
        } else {
            playSound('error');
            alert(`Kh√¥ng ƒë·ªß xu! Ch·ª©c nƒÉng n√†y c·∫ßn ${cost} xu, b·∫°n ch·ªâ c√≤n ${currentUserCoins} xu.`);
        }
    }
    
    function checkLoginCode() {
        playSound('click');
        const usernameInput = document.getElementById("username"), codeInput = document.getElementById("loginCode"), errorEl = document.getElementById("error");
        const username = usernameInput.value.trim(), code = codeInput.value.trim().toUpperCase();
        if (!username) { errorEl.textContent = "Vui l√≤ng nh·∫≠p T√™n t√†i kho·∫£n!"; return; }
        if (!code) { errorEl.textContent = "Vui l√≤ng nh·∫≠p M√£ truy c·∫≠p!"; return; }

        let storedCoins = JSON.parse(localStorage.getItem(COIN_STORAGE_KEY));
        if (!storedCoins) {
            storedCoins = { ...initialCodeCoinData };
            localStorage.setItem(COIN_STORAGE_KEY, JSON.stringify(storedCoins));
        }

        if (initialCodeCoinData.hasOwnProperty(code)) {
            if (storedCoins[code] === 0) {
                playSound('error');
                errorEl.textContent = "M√£ n√†y ƒë√£ h·∫øt xu!";
                return;
            }
            
            playSound('success');
            loggedInUsername = username;
            loggedInCode = code;
            currentUserCoins = storedCoins[code] || initialCodeCoinData[code];
            initialUserCoins = initialCodeCoinData[code];
            updateCoinDisplay();

            document.getElementById('welcomeMessage').textContent = `XIN CH√ÄO, ${loggedInUsername.toUpperCase()}`;
            errorEl.textContent = "";
            setScreenVisibility(DOM.appScreen, [DOM.loginScreen]);
            const isVip = gen4Codes.includes(code);
            selectAI(isVip ? 'gen4' : 'base');
        } else {
             playSound('error');
             errorEl.textContent = "M√£ truy c·∫≠p kh√¥ng ch√≠nh x√°c. Vui l√≤ng th·ª≠ l·∫°i!";
        }
    }

    function selectAI(type) {
        chosenAI = type;
        const jarHuntBtn = document.getElementById('jarHuntBtn');
        const playWithAIBtn = document.getElementById('playWithAIBtn');
        
        if (type === 'gen4') {
            DOM.menuContainer.classList.add('menu-vip');
            DOM.menuContainer.classList.remove('menu-base');
            DOM.mainContent.classList.add('vip-mode');
            jarHuntBtn.style.display = 'flex';
            playWithAIBtn.style.display = 'flex';
        } else { 
            DOM.menuContainer.classList.add('menu-base');
            DOM.menuContainer.classList.remove('menu-vip');
            DOM.mainContent.classList.remove('vip-mode');
            jarHuntBtn.style.display = 'none';
            playWithAIBtn.style.display = 'none';
        }
        
        setScreenVisibility(DOM.menuContainer, [DOM.aiChoiceContainer]);
        updateVideoBackground('menu'); 
        startDashboard();
    }
    
    function startDashboard() {
        if(dashboardInterval) clearInterval(dashboardInterval);
        const update = () => {
            document.getElementById('systemStatus').textContent = 'ONLINE';
            document.getElementById('networkPing').textContent = Math.floor(Math.random() * (70 - 20) + 20) + 'ms';
            document.getElementById('activeAI').textContent = chosenAI === 'gen4' ? 'TH·∫æ H·ªÜ 4' : 'C∆† B·∫¢N';
        };
        update();
        dashboardInterval = setInterval(update, 3000);
    }

    function showGameSelection() {
        const gameList = document.getElementById('game-list');
        gameList.innerHTML = '';
        gameData.forEach(game => {
            const gameButton = document.createElement('button');
            gameButton.className = 'game-btn';
            gameButton.textContent = game.name;
            gameButton.onclick = () => { startSpecificScan(game, 'analysis'); };
            gameList.appendChild(gameButton);
        });
        switchView(DOM.gameSelectionContainer, [DOM.menuContainer]);
    }
    
    function startAutoScan() {
        const randomGame = gameData[Math.floor(Math.random() * gameData.length)];
        startSpecificScan(randomGame, 'analysis');
    }
    
    function startJarHunt() {
        const randomGame = gameData[Math.floor(Math.random() * gameData.length)];
        startSpecificScan(randomGame, 'jarHunt');
    }

    function startSpecificScan(game, mode) {
        const loadingGif = document.getElementById('loadingGif');
        const scanTitle = document.getElementById('scanTitle');
        loadingGif.src = (chosenAI === 'gen4') ? 'https://i.ibb.co/C30H2ZYr/Nft-Hacker-GIF-by-Cyber-Brokers.gif' : 'https://i.ibb.co/nsw6D7cw/Art-Animation-GIF-by-xponentialdesign.gif';
        scanTitle.textContent = (mode === 'jarHunt') ? 'ƒêANG QU√âT C√ÅC GAME C√ì H≈® L·ªöN...' : 'ƒêANG PH√ÇN T√çCH L·ªñ H·ªîNG...';
        setScreenVisibility(DOM.scanningContainer, [DOM.gameSelectionContainer, DOM.resultContainer, DOM.menuContainer]);
        updateVideoBackground('none');
        playSound('scan');
        setTimeout(() => showResults(game, mode), 4500);
    }
    
    function showResults(selectedGame, mode) {
        stopSound('scan');
        playSound('success');
        setScreenVisibility(DOM.resultContainer, [DOM.scanningContainer]);
        
        document.getElementById('gameName').textContent = selectedGame.name;
        document.getElementById('gameImage').src = selectedGame.image;
        const goldenTime = calculateGoldenTime();
        document.getElementById('goldenTime').textContent = goldenTime;

        let historyEntry = { game: selectedGame, goldenTime, timestamp: new Date() };

        if (mode === 'jarHunt') {
            document.querySelector('.result-stats').classList.add('hidden');
            const reasoningEl = document.getElementById('scanReasoning');
            const randomSessions = Math.floor(Math.random() * 2000000) + 500000;
            reasoningEl.innerHTML = `Ph√¢n t√≠ch <strong>${randomSessions.toLocaleString('vi-VN')}</strong> phi√™n g·∫ßn nh·∫•t cho th·∫•y game <strong>${selectedGame.name}</strong> ƒëang c√≥ t·∫ßn su·∫•t tr·∫£ th∆∞·ªüng cao b·∫•t th∆∞·ªùng. ƒê·ªÅ xu·∫•t v√†o ngay!`;
            reasoningEl.classList.remove('hidden');
            historyEntry.type = 'SƒÉn H≈©';
        } else {
            document.querySelector('.result-stats').classList.remove('hidden');
            document.getElementById('scanReasoning').classList.add('hidden');
            const winRate = (chosenAI === 'gen4') ? (Math.random() * (98.5 - 85) + 85) : (Math.random() * (92.5 - 75) + 75);
            const spinCount = Math.floor(Math.random() * (250 - 120 + 1)) + 120;
            const scatterRate = (Math.random() * (90 - 50) + 50);
            animateCountUp(document.getElementById('winRate'), winRate, 2, '%');
            animateCountUp(document.getElementById('spinCount'), spinCount, 0, ' v√≤ng');
            animateCountUp(document.getElementById('scatterRate'), scatterRate, 2, '%');
            historyEntry.type = 'Ph√¢n t√≠ch';
            historyEntry.winRate = winRate;
        }

        scanHistory.unshift(historyEntry);
        if (scanHistory.length > 5) scanHistory.pop();
        
        document.getElementById('financeAllocatorContainer').classList.remove('hidden');
        document.getElementById('financeResult').innerHTML = "";
        document.getElementById('capitalInput').value = "";
    }
    
    function displayScanHistory() {
        const historyContent = document.getElementById('historyContent');
        historyContent.innerHTML = '';
        if (scanHistory.length === 0) {
            historyContent.innerHTML = '<p>Ch∆∞a c√≥ l·ªãch s·ª≠ qu√©t.</p>';
        } else {
            scanHistory.forEach(entry => {
                const item = document.createElement('div');
                item.className = 'history-item';
                let details = `<p><strong>Game:</strong> ${entry.game.name}</p><p><strong>Lo·∫°i:</strong> ${entry.type}</p>`;
                if(entry.winRate) details += `<p><strong>T·ªâ l·ªá th·∫Øng:</strong> ${entry.winRate.toFixed(2)}%</p>`;
                details += `<p><strong>Khung gi·ªù v√†ng:</strong> ${entry.goldenTime}</p><p><small>Th·ªùi gian: ${entry.timestamp.toLocaleString('vi-VN')}</small></p>`;
                item.innerHTML = details;
                historyContent.appendChild(item);
            });
        }
        showModal(DOM.modals.history);
    }
    
    function runSecurityCheck() {
        const modal = DOM.modals.security, messageEl = document.getElementById('securityMessage'), closeBtn = document.getElementById('closeSecurityModalBtn');
        messageEl.innerHTML = "";
        closeBtn.classList.add('hidden');
        showModal(modal);
        playSound('scan');
        const logMessages = [
            "ƒêANG PH√ÇN T√çCH T√ÄI KHO·∫¢N...", "ƒêANG KI·ªÇM TRA L·ªäCH S·ª¨ TH·∫ÆNG...", "ƒêANG KI·ªÇM TRA IP HI·ªÜN T·∫†I...",
            "<span style='color:var(--error-red)'>PH√ÅT HI·ªÜN THEO D√ïI T·ª™ S·∫¢NH GAME!</span>", "...................", "ƒêANG XO√Å THEO D√ïI...",
            "ƒêANG XO√Å IP C≈®...", "ƒêANG THAY TH·∫æ IP B·∫¢O M·∫¨T...", "ƒêANG L√ÄM S·∫†CH B·ªò NH·ªö ƒê·ªÜM...",
            "<strong style='color:var(--primary-color)'>T√ÄI KHO·∫¢N ƒê√É ƒê∆Ø·ª¢C L√ÄM S·∫†CH V√Ä B·∫¢O V·ªÜ.</strong>", "<strong>B·∫¢O M·∫¨T KH√îI PH·ª§C 100%. CH√öC MAY M·∫ÆN!</strong>"
        ];
        let i = 0;
        const interval = setInterval(() => {
            if (i < logMessages.length) {
                messageEl.innerHTML += logMessages[i] + "<br>";
                messageEl.scrollTop = messageEl.scrollHeight;
                i++;
            } else {
                clearInterval(interval);
                stopSound('scan');
                playSound('success');
                closeBtn.classList.remove('hidden');
            }
        }, 900);
    }
    
    function calculateAndDisplayFinance() {
        const capitalInput = document.getElementById('capitalInput'), resultDiv = document.getElementById('financeResult'), rawValue = parseInt(capitalInput.value, 10);
        if (isNaN(rawValue) || rawValue <= 0) { resultDiv.innerHTML = `<p style="color: var(--error-red);">Vui l√≤ng nh·∫≠p m·ªôt s·ªë v·ªën h·ª£p l·ªá.</p>`; return; }
        const totalCapital = rawValue * 1000;
        const exploreBet = (totalCapital * 0.01).toLocaleString('vi-VN');
        const attackBet = (totalCapital * 0.025).toLocaleString('vi-VN');
        const stopLoss = (totalCapital * 0.3).toLocaleString('vi-VN');
        resultDiv.innerHTML = `
            <p><strong>T·ªïng v·ªën:</strong> ${totalCapital.toLocaleString('vi-VN')} ƒë</p>
            <p><strong>Giai ƒëo·∫°n 1 (ThƒÉm d√≤):</strong> C∆∞·ª£c <strong>${exploreBet} ƒë/v√≤ng</strong> trong 15 v√≤ng.</p>
            <p><strong>Giai ƒëo·∫°n 2 (T·∫•n c√¥ng):</strong> N·∫øu th·∫Øng l·ªõn, tƒÉng c∆∞·ª£c l√™n <strong>${attackBet} ƒë/v√≤ng</strong>.</p>
            <p><strong>Giai ƒëo·∫°n 3 (B·∫£o to√†n):</strong> N·∫øu thua <strong>${stopLoss} ƒë</strong>, d·ª´ng l·∫°i v√† ch·∫°y l·∫°i Ki·ªÉm Tra B·∫£o M·∫≠t.</p>
        `;
    }
    
    function calculateGoldenTime() {
        const now = new Date(), startOffset = Math.floor(Math.random() * 21) + 5, endTime = startOffset + (Math.floor(Math.random() * 6) + 10);
        const startTime = new Date(now.getTime() + startOffset * 60000), finalEndTime = new Date(now.getTime() + endTime * 60000);
        const formatTime = (date) => date.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });
        return `${formatTime(startTime)} - ${formatTime(finalEndTime)}`;
    }

    function animateCountUp(el, end, decimals, suffix) {
        let start = 0, duration = 1500, frameRate = 1000 / 60, totalFrames = Math.round(duration / frameRate), increment = end / totalFrames, currentFrame = 0;
        const counter = setInterval(() => { start += increment; currentFrame++; if (start > end) start = end; el.textContent = `${start.toFixed(decimals)}${suffix}`; if (currentFrame === totalFrames) clearInterval(counter); }, frameRate);
    }
    
    function goBackToChoices() {
        if(dashboardInterval) clearInterval(dashboardInterval);
        switchView(DOM.aiChoiceContainer, [DOM.menuContainer]);
        updateVideoBackground('aiChoice');
    }

    function goBackToMenu() { 
        switchView(DOM.menuContainer, [DOM.resultContainer, DOM.gameSelectionContainer]); 
        updateVideoBackground('menu'); 
        startDashboard(); 
    }
    
    const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));
    
    async function startCinematicIntro() {
        const overlay = DOM.cinematicIntro;
        const lines = [document.getElementById('introLine1'), document.getElementById('introLine2'), document.getElementById('introLine3')];
        const endIntro = () => {
            if (introHasEnded) return;
            introHasEnded = true;
            overlay.style.opacity = '0';
            setScreenVisibility(DOM.loginScreen);
            updateVideoBackground('login');
            setTimeout(() => { overlay.classList.add('hidden'); }, 1000);
        };
        overlay.addEventListener('click', endIntro, { once: true });
        await sleep(500); if(introHasEnded) return; lines[0].classList.add('visible');
        await sleep(2000); if(introHasEnded) return; lines[0].classList.remove('visible');
        await sleep(500); if(introHasEnded) return; lines[1].classList.add('visible');
        await sleep(2000); if(introHasEnded) return; lines[1].classList.remove('visible');
        await sleep(500); if(introHasEnded) return; lines[2].classList.add('visible');
        await sleep(2000); if(introHasEnded) return;
        endIntro();
    }

    function showInactivityWarning() { showModal(DOM.modals.inactivity); }
    function resetInactivityTimer() { clearTimeout(inactivityTimer); inactivityTimer = setTimeout(showInactivityWarning, 15 * 60 * 1000); }

    document.addEventListener('DOMContentLoaded', () => {
        startCinematicIntro();
        document.getElementById('settingsBtn').addEventListener('click', () => { playSound('click'); showModal(DOM.modals.settings); });
        document.getElementById('closeSettingsModalBtn').addEventListener('click', () => hideModal(DOM.modals.settings));
        document.getElementById('soundToggle').addEventListener('change', (e) => { isSoundEnabled = e.target.checked; });
        document.querySelectorAll('.swatch').forEach(swatch => {
            swatch.addEventListener('click', (e) => {
                const newColor = e.target.dataset.color;
                document.documentElement.style.setProperty('--primary-color', newColor);
                document.documentElement.style.setProperty('--border-color', newColor + '40'); 
                document.querySelectorAll('.swatch').forEach(s => s.classList.remove('active'));
                e.target.classList.add('active');
            });
        });

        document.getElementById('calculateFinanceBtn').addEventListener('click', () => { playSound('click'); calculateAndDisplayFinance(); });
        document.getElementById('choiceAILongBao').addEventListener('click', () => selectAI('base'));
        document.getElementById('choiceAILongBao4').addEventListener('click', () => { playSound('click'); showModal(DOM.modals.code); });
        document.getElementById('submitGen4CodeBtn').addEventListener('click', () => {
            const codeInput = document.getElementById('gen4CodeInput'), errorEl = document.getElementById('codeError');
            const code = codeInput.value.trim().toUpperCase();
            if (gen4Codes.includes(code)) {
                let storedCoins = JSON.parse(localStorage.getItem(COIN_STORAGE_KEY));
                if (!storedCoins) {
                    storedCoins = { ...initialCodeCoinData };
                    localStorage.setItem(COIN_STORAGE_KEY, JSON.stringify(storedCoins));
                }
                if (storedCoins[code] === 0) {
                     playSound('error');
                     errorEl.textContent = "M√£ n√†y ƒë√£ h·∫øt xu!";
                     return;
                }
                hideModal(DOM.modals.code);
                loggedInCode = code;
                currentUserCoins = storedCoins[code] || initialCodeCoinData[code];
                initialUserCoins = initialCodeCoinData[code];
                updateCoinDisplay();
                selectAI('gen4'); 
                codeInput.value = ''; 
                errorEl.textContent = ''; 
            } else { 
                playSound('error');
                errorEl.textContent = 'M√£ VIP kh√¥ng h·ª£p l·ªá!'; 
            }
        });
        document.getElementById('closeCodeModalBtn').addEventListener('click', () => hideModal(DOM.modals.code));
        
        document.getElementById('autoScanBtn').addEventListener('click', () => useFeature('autoScan', startAutoScan));
        document.getElementById('startAnalysisBtn').addEventListener('click', () => useFeature('startAnalysis', showGameSelection));
        document.getElementById('jarHuntBtn').addEventListener('click', () => useFeature('jarHunt', startJarHunt));
        document.getElementById('securityCheckBtn').addEventListener('click', () => useFeature('securityCheck', runSecurityCheck));
        document.getElementById('playWithAIBtn').addEventListener('click', () => useFeature('playWithAI', () => {
            if (typeof Tawk_API !== 'undefined' && typeof Tawk_API.toggle === 'function') {
                Tawk_API.toggle();
            }
        }));

        document.getElementById('historyBtn').addEventListener('click', () => { playSound('click'); displayScanHistory(); });
        document.getElementById('capitalPreserveBtn').addEventListener('click', () => { playSound('click'); showModal(DOM.modals.capital); });
        document.getElementById('backToChoiceBtn').addEventListener('click', goBackToChoices);
        document.getElementById('backToMenuBtn').addEventListener('click', goBackToMenu);
        document.getElementById('backToMenuFromGameSelectBtn').addEventListener('click', goBackToMenu);
        document.getElementById('closeSecurityModalBtn').addEventListener('click', () => { hideModal(DOM.modals.security); stopSound('scan'); });
        document.getElementById('closeWarningModalBtn').addEventListener('click', () => hideModal(DOM.modals.capital));
        document.getElementById('closeHistoryModalBtn').addEventListener('click', () => hideModal(DOM.modals.history));
        
        Object.values(DOM.modals).forEach(modal => { if(modal.id !== 'inactivityWarningModal') { modal.addEventListener('click', (e) => { if (e.target === modal) { hideModal(modal); stopSound('scan'); } }); } });
        ['mousemove', 'mousedown', 'touchstart', 'keypress'].forEach(evt => document.addEventListener(evt, resetInactivityTimer, false));
    });
</script>
</body>
</html>
